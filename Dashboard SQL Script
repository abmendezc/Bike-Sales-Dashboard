-- Bike Sales EDA 
SELECT * FROM Bike_Sales..Sales$ 
-- 113,036 different sales
-- $85,271,008 total revenue
-- $32,221,100 total profit 
-- $53,049,908 total costs from sales 
-- Sales range from 2011-2016

SELECT SUM(Cost)
FROM Bike_Sales..Sales$

SELECT COUNT(*)
FROM Bike_Sales..Sales$
WHERE Month IS NULL; -- none 

-- Months 
SELECT Month, COUNT(Month) AS Sales,
(SELECT COUNT(Month)
FROM Bike_Sales..Sales$) AS 'Total Sales'
FROM Bike_Sales..Sales$ -- Number of sales by month 
GROUP BY Month  
ORDER BY 2 DESC
-- June and December are the two months with the highest sales (beggining of summer and holidays perhaps). After that late spring months 
-- have the highest sales with the summer months having the least sales. 

SELECT Month, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY Month
ORDER BY 2 DESC -- profit by month 
-- December, June and May are the top 3 highest selling months (same pattern as above) 

SELECT Month, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Month 
ORDER BY 2 DESC -- cost by month 
------------
-- Product Category 

SELECT DISTINCT(Product_Category)
FROM Bike_Sales..Sales$ -- Clothing, Bikes and Accessories 

SELECT Product_Category, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY Product_Category
ORDER BY 2 DESC -- Profit generated by each category; Bikes (63%), Accessories (28%), Clothing (9%)(Pie Chart) 

SELECT Product_Category, COUNT(Product_Category)
FROM Bike_Sales..Sales$
GROUP BY Product_Category
ORDER BY 2 DESC -- Sales by product category; 62% sales were accessories but only responsilbe for 28% of total profit 

SELECT Product_Category, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Product_Category
ORDER BY 2 DESC -- Cost by category: Bikes, Accessories and Clothing
--------------------------------------------------------
-- Sub Category (Seperate into main categories by color on graphs)
SELECT Sub_Category, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY Sub_Category
ORDER BY 2 DESC -- Profit by Sub Category (Bar Graph)

SELECT Sub_Category, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Sub_Category
ORDER BY 2 DESC -- Cost by Sub Category 

SELECT Sub_Category, COUNT(Sub_Category) 
FROM Bike_Sales..Sales$
GROUP BY Sub_Category
ORDER BY 2 DESC -- Sales by Sub Category 
-----------------------------------------------
-- Product 
SELECT Product, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY Product
ORDER BY 2 DESC -- Total profit by product 

SELECT Product, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Product
ORDER BY 2 DESC -- Total cost by product 

SELECT Product, COUNT(Product)
FROM Bike_Sales..Sales$
GROUP BY Product
ORDER BY 2 DESC -- Number of sales by product 

SELECT Product, Unit_Price, Unit_Cost
FROM Bike_Sales..Sales$
GROUP BY Product, Unit_Cost, Unit_Price
ORDER BY 3 DESC -- Unit price and unit cost by product 
----------------------------------------------------
-- Country 
SELECT Country, COUNT(Country)
FROM Bike_Sales..Sales$
GROUP BY COUNTRY
ORDER BY 2 DESC -- Sales by Country: US, Australia, Canada 

SELECT Country, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY COUNTRY
ORDER BY 2 DESC -- Profit by country: US, Australia, United Kingdom 

SELECT Country, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Country 
ORDER BY 2 DESC -- Cost by country: US, Australia, UK 

-----------
-- Sales misc 

SELECT Year, COUNT(Year)
FROM Bike_Sales..Sales$ 
GROUP BY Year 
ORDER BY 2 DESC -- Sales by year 

SELECT Age_Group, COUNT(Age_Group)
FROM Bike_Sales..Sales$
GROUP BY Age_Group
ORDER BY 2 DESC -- Sales by Age Group

SELECT Customer_Gender, COUNT(Customer_Gender) 
FROM Bike_Sales..Sales$
GROUP BY Customer_Gender -- Sales by gender

SELECT AVG(Order_Quantity) AS Avg_Sales, MAX(Order_Quantity) AS Biggest_Sale,MIN(Order_Quantity) Smallest_Sale
FROM Bike_Sales..Sales$ -- 11.9 ~ 12 items avg, 32 items biggest sale, 1 item smallest sale

SELECT Month, AVG(Order_Quantity)
FROM Bike_Sales..Sales$
GROUP BY Month
ORDER BY 2 DESC -- Every month has an average sale size of 11.3-12.63 items
---------------------------------
-- Profit Misc

SELECT Year, SUM(Profit)
FROM Bike_Sales..Sales$ 
GROUP BY Year 
ORDER BY 2 DESC -- Profit by year 

SELECT Age_Group, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY Age_Group
ORDER BY 2 DESC -- Profit by age group 

SELECT Customer_Gender, SUM(Profit)
FROM Bike_Sales..Sales$
GROUP BY Customer_Gender -- profit by gender
-------------------------------------
-- Costs Misc
SELECT Year, SUM(Cost)
FROM Bike_Sales..Sales$ 
GROUP BY Year 
ORDER BY 2 DESC -- cost by year 

SELECT Age_Group, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Age_Group
ORDER BY 2 DESC -- cost by age group 

SELECT Customer_Gender, SUM(Cost)
FROM Bike_Sales..Sales$
GROUP BY Customer_Gender -- cost by gender


SELECT Product_Category, AVG(Unit_Price)
FROM Bike_Sales..Sales$
GROUP BY Product_Category
ORDER BY 2; -- avg price by category
SELECT Product_Category, AVG(Unit_Cost)
FROM Bike_Sales..Sales$
GROUP BY Product_Category
ORDER BY 2; -- avg cost by category
